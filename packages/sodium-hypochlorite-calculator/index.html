<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sodium Hypochlorite Filter Dosing Calculator</title>
    <style>
        * {
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #00677f 0%, #4a90a4 100%);
            min-height: 100vh;
            color: #333;
            line-height: 1.6;
            margin: 0;
            padding: 20px;
        }
        
        .container {
            min-height: 100vh;
            display: flex;
            flex-direction: column;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        /* Header Styles */
        .header {
            text-align: center;
            margin-bottom: 1.5rem;
            padding: 1rem 0;
        }

        .brand {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 16px;
            padding: 1.5rem;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
        }

        .header-top {
            display: flex;
            justify-content: flex-start;
            margin-bottom: 1rem;
        }

        .logo-container {
            display: flex;
            justify-content: center;
            margin-bottom: 1rem;
        }

        .logo-image {
            height: 80px;
            width: auto;
            object-fit: contain;
        }

        .brand-text {
            text-align: center;
        }

        .brand-text h1 {
            color: #00677f;
            font-size: 2rem;
            font-weight: 700;
            margin: 0 0 0.5rem 0;
            line-height: 1.2;
        }

        .tagline {
            color: #4a90a4;
            font-size: 1.1rem;
            font-weight: 400;
            opacity: 0.8;
            margin: 0;
        }
        
        .back-to-dashboard-btn {
            background: rgba(0, 103, 127, 0.1);
            color: #00677f;
            border: 2px solid rgba(0, 103, 127, 0.2);
            padding: 0.6rem 1.2rem;
            border-radius: 25px;
            font-size: 0.9rem;
            font-weight: 600;
            text-decoration: none;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            margin-bottom: 1.5rem;
        }
        
        .back-to-dashboard-btn:hover {
            background: rgba(0, 103, 127, 0.2);
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(0, 103, 127, 0.3);
            text-decoration: none;
            color: #00677f;
        }
        
        .card {
            background: #f8f9fa;
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 25px;
            border: 1px solid #e9ecef;
            box-shadow: 0 2px 8px rgba(0,0,0,0.05);
        }
        
        .main-content {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 16px;
            padding: 2rem;
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            flex: 1;
        }

        .input-section {
            background: linear-gradient(145deg, #ffffff, #f8f9fa);
            border-radius: 12px;
            padding: 25px;
            margin-bottom: 25px;
            box-shadow: inset 0 2px 4px rgba(0,0,0,0.06);
        }
        
        .input-group {
            margin-bottom: 25px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #2c3e50;
            font-size: 1.1em;
        }
        
        input {
            width: 100%;
            padding: 15px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            font-size: 16px;
            transition: all 0.3s ease;
            background: white;
        }
        
        input:focus {
            outline: none;
            border-color: #00677f;
            box-shadow: 0 0 0 3px rgba(0, 103, 127, 0.1);
        }
        
        button {
            width: 100%;
            padding: 1rem 2rem;
            background: linear-gradient(135deg, #00677f, #4a90a4);
            color: white;
            border: none;
            border-radius: 10px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        button:hover {
            background: linear-gradient(135deg, #005c73, #3e7b8c);
            transform: translateY(-2px);
            box-shadow: 0 8px 25px rgba(0, 103, 127, 0.3);
        }
        
        button:active {
            transform: translateY(0);
        }
        
        .result {
            margin-top: 30px;
            padding: 25px;
            background: linear-gradient(145deg, #d4edda, #c3e6cb);
            border-radius: 12px;
            border-left: 5px solid #28a745;
            box-shadow: 0 4px 15px rgba(40, 167, 69, 0.2);
        }
        
        .result h3 {
            margin-top: 0;
            color: #155724;
            font-size: 1.4em;
            display: flex;
            align-items: center;
        }
        
        .result h3::before {
            content: "üß™";
            margin-right: 10px;
            font-size: 1.2em;
        }
        
        .calculation-steps {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 8px;
            padding: 20px;
            margin: 20px 0;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        .calculation-steps h4 {
            color: #495057;
            margin-top: 0;
            font-family: 'Segoe UI', sans-serif;
            display: flex;
            align-items: center;
        }
        
        .calculation-steps h4::before {
            content: "üìä";
            margin-right: 8px;
        }
        
        .formula {
            background: #e9ecef;
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
            font-weight: bold;
            color: #495057;
        }
        
        .step {
            margin: 15px 0;
            padding: 10px;
            background: white;
            border-radius: 5px;
            border-left: 3px solid #007bff;
        }
        
        .info {
            background: linear-gradient(145deg, #e3f2fd, #bbdefb);
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 25px;
            border-left: 5px solid #2196f3;
            box-shadow: 0 2px 8px rgba(33, 150, 243, 0.15);
        }
        
        .info h3 {
            margin-top: 0;
            color: #0d47a1;
            display: flex;
            align-items: center;
        }
        
        .info h3::before {
            content: "‚ÑπÔ∏è";
            margin-right: 10px;
        }
        
        .error {
            background: linear-gradient(145deg, #f8d7da, #f5c6cb);
            color: #721c24;
            padding: 15px;
            border-radius: 8px;
            margin-top: 15px;
            border-left: 5px solid #dc3545;
            font-weight: 500;
        }
        
        .highlight {
            background: #fff3cd;
            padding: 2px 6px;
            border-radius: 4px;
            font-weight: bold;
            color: #856404;
        }
        
        @media (max-width: 768px) {
            body {
                margin: 10px;
                padding: 10px;
            }
            
            .container {
                padding: 25px;
            }
            
            h1 {
                font-size: 1.8em;
            }
        }
    </style>
</head>
<body>
    <div class="container">
      <header class="header">
        <div class="brand">
          <div class="header-top">
            <a href="../../" class="back-to-dashboard-btn">
              ‚Üê Back to Dashboard
            </a>
          </div>
          <div class="logo-container">
            <img
              src="../../city-logos/logo-vert.png"
              alt="City Logo"
              class="logo-image"
            />
          </div>
          <div class="brand-text">
            <h1>Sodium Hypochlorite Filter Dosing Calculator</h1>
            <p class="tagline">
              Calculate chemical addition to filter basins for residual increase
            </p>
          </div>
        </div>
      </header>

      <main class="main-content">        
        <div class="input-section">
            <h3 style="margin-top: 0; color: #2c3e50; margin-bottom: 25px;">Filter Basin Parameters</h3>
            
            <div class="input-group">
                <label for="basinVolume">Filter Basin Volume (gallons):</label>
                <input type="number" id="basinVolume" step="1" min="0" value="35400" placeholder="Enter basin volume">
                <small style="color: #6c757d; font-size: 0.9em; margin-top: 5px; display: block;">
                    <em>Note: Our filters are typically 35,000 gallons</em>
                </small>
            </div>
            
            <div class="input-group">
                <label for="hypochloriteConcentration">Sodium Hypochlorite Concentration (%):</label>
                <input type="number" id="hypochloriteConcentration" step="0.1" min="0" max="100" value="10" placeholder="Enter concentration">
                <small style="color: #6c757d; font-size: 0.9em; margin-top: 5px; display: block;">
                    <em>Note: Our normal hypochlorite concentration is 10%</em>
                </small>
            </div>

            <div class="input-group">
                <label for="residualIncrease">Desired Filter Basin Residual Increase (mg/L or ppm):</label>
                <input type="number" id="residualIncrease" step="0.1" min="0" placeholder="Enter desired residual increase (e.g., 1.0)">
            </div>

            <button onclick="calculateDosage()">Calculate Filter Basin Dosage</button>
        </div>

        <div id="result" class="result" style="display: none;">
            <h3>Filter Basin Dosage Required</h3>
            <p id="dosageAmount"></p>
            <p id="dosageVolume"></p>
            
            <div id="calculations" class="calculation-steps">
                <h4>How This Was Calculated</h4>
                <div class="formula">Basic Formula: Dosage (lbs) = (Desired Increase √ó Volume √ó 8.34) √∑ (Chemical Strength √ó 1,000,000)</div>
                
                <div id="step1" class="step"></div>
                <div id="step2" class="step"></div>
                <div id="step3" class="step"></div>
                <div id="step4" class="step"></div>
                
                <div style="margin-top: 15px; padding: 10px; background: #e3f2fd; border-radius: 5px;">
                    <strong>Key Constants:</strong><br>
                    ‚Ä¢ 8.34 = conversion factor (lbs per gallon of water)<br>
                    ‚Ä¢ 1,000,000 = converts ppm to decimal<br>
                    ‚Ä¢ 128 = fluid ounces per gallon<br>
                    ‚Ä¢ 3,785.41 = milliliters per gallon
                </div>
            </div>
            
            <p style="margin-top: 20px; padding: 15px; background: #fff3cd; border-radius: 8px; border-left: 4px solid #ffc107;">
                <strong>‚ö†Ô∏è Important Note:</strong> This calculation is for filter basin chemical addition to increase residual levels. It assumes uniform mixing and does not account for chlorine demand or decay. Always verify with residual testing and adjust based on actual filter basin conditions.
            </p>
        </div>

        <div id="error" class="error" style="display: none;"></div>
      </main>
    </div>

    <script>
        function calculateDosage() {
            const residualIncrease = parseFloat(document.getElementById('residualIncrease').value);
            const basinVolume = parseFloat(document.getElementById('basinVolume').value);
            const hypochloriteConcentrationPercent = parseFloat(document.getElementById('hypochloriteConcentration').value);
            const errorDiv = document.getElementById('error');
            const resultDiv = document.getElementById('result');
            
            errorDiv.style.display = 'none';
            resultDiv.style.display = 'none';
            
            // Validation
            if (isNaN(residualIncrease) || residualIncrease <= 0) {
                errorDiv.textContent = 'Please enter a valid positive number for residual increase.';
                errorDiv.style.display = 'block';
                return;
            }
            
            if (isNaN(basinVolume) || basinVolume <= 0) {
                errorDiv.textContent = 'Please enter a valid positive number for basin volume.';
                errorDiv.style.display = 'block';
                return;
            }
            
            if (isNaN(hypochloriteConcentrationPercent) || hypochloriteConcentrationPercent <= 0 || hypochloriteConcentrationPercent > 100) {
                errorDiv.textContent = 'Please enter a valid concentration between 0 and 100%.';
                errorDiv.style.display = 'block';
                return;
            }
            
            if (residualIncrease > 10) {
                errorDiv.textContent = 'Warning: Residual increase over 10 mg/L is unusually high. Please verify your input.';
                errorDiv.style.display = 'block';
            }
            
            // Constants and conversions
            const hypochloriteConcentration = hypochloriteConcentrationPercent / 100; // Convert % to decimal
            const conversionFactor = 8.34;
            
            // Main calculation
            const dosageLbsPerDay = (residualIncrease * basinVolume * conversionFactor) / (hypochloriteConcentration * 1000000);
            const dosageGallons = dosageLbsPerDay / (hypochloriteConcentration * 8.34);
            const dosageOunces = dosageGallons * 128;
            const dosageMl = dosageGallons * 3785.41;
            
            // Display results
            document.getElementById('dosageAmount').innerHTML = 
                `<div style="text-align: center; margin: 20px 0;">
                    <div style="font-size: 2.5em; font-weight: bold; color: #155724; margin-bottom: 10px;">
                        ${dosageGallons.toFixed(2)} gallons
                    </div>
                    <div style="font-size: 2em; font-weight: bold; color: #155724; margin-bottom: 15px;">
                        ${dosageMl.toFixed(0)} mL
                    </div>
                    <div style="font-size: 1.1em; color: #6c757d;">
                        (${dosageLbsPerDay.toFixed(4)} lbs of ${hypochloriteConcentrationPercent}% sodium hypochlorite solution)
                    </div>
                </div>`;
            
            document.getElementById('dosageVolume').innerHTML = '';
            
            // Show calculation steps
            document.getElementById('step1').innerHTML = 
                `<strong>Step 1:</strong> Calculate chemical weight needed<br>
                Dosage (lbs) = (${residualIncrease} mg/L √ó ${basinVolume.toLocaleString()} gal √ó 8.34) √∑ (${hypochloriteConcentration.toFixed(2)} √ó 1,000,000)<br>
                Dosage (lbs) = ${(residualIncrease * basinVolume * conversionFactor).toLocaleString()} √∑ ${(hypochloriteConcentration * 1000000).toLocaleString()} = <strong>${dosageLbsPerDay.toFixed(4)} lbs</strong>`;
            
            document.getElementById('step2').innerHTML = 
                `<strong>Step 2:</strong> Convert weight to volume<br>
                Volume (gal) = Weight (lbs) √∑ (Concentration √ó 8.34 lbs/gal)<br>
                Volume (gal) = ${dosageLbsPerDay.toFixed(4)} √∑ (${hypochloriteConcentration.toFixed(2)} √ó 8.34) = <strong>${dosageGallons.toFixed(4)} gallons</strong>`;
            
            document.getElementById('step3').innerHTML = 
                `<strong>Step 3:</strong> Convert to milliliters<br>
                Volume (mL) = ${dosageGallons.toFixed(4)} gal √ó 3,785.41 mL/gal = <strong>${dosageMl.toFixed(0)} mL</strong>`;
            
            document.getElementById('step4').innerHTML = 
                `<strong>Summary:</strong> For ${basinVolume.toLocaleString()} gallons at ${hypochloriteConcentrationPercent}% concentration<br>
                <strong>Required dosage:</strong> ${dosageGallons.toFixed(4)} gallons (${dosageMl.toFixed(0)} mL)`;
            
            resultDiv.style.display = 'block';
            
            // Smooth scroll to results
            setTimeout(() => {
                resultDiv.scrollIntoView({ behavior: 'smooth', block: 'start' });
            }, 100);
        }
        
        document.getElementById('residualIncrease').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                calculateDosage();
            }
        });
        
        // Add input validation styling
        document.getElementById('residualIncrease').addEventListener('input', function(e) {
            const value = parseFloat(e.target.value);
            if (value > 10) {
                e.target.style.borderColor = '#ffc107';
                e.target.style.backgroundColor = '#fff3cd';
            } else if (value > 0) {
                e.target.style.borderColor = '#00677f';
                e.target.style.backgroundColor = '#e8f4f6';
            } else {
                e.target.style.borderColor = '#e9ecef';
                e.target.style.backgroundColor = 'white';
            }
        });
    </script>
</body>
</html>